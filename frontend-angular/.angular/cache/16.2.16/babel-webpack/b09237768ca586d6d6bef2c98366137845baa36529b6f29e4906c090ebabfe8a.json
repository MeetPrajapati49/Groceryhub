{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../core/api.service\";\nexport let WishlistService = /*#__PURE__*/(() => {\n  class WishlistService {\n    constructor(api) {\n      this.api = api;\n      this.itemsSubject = new BehaviorSubject([]);\n      this.items$ = this.itemsSubject.asObservable();\n      this.load();\n    }\n    getSnapshot() {\n      return this.itemsSubject.value;\n    }\n    load() {\n      this.api.get('/wishlist').subscribe({\n        next: res => this.itemsSubject.next(res?.items || []),\n        error: () => {\n          const local = JSON.parse(localStorage.getItem('wishlist') || '[]');\n          this.itemsSubject.next(local);\n        }\n      });\n    }\n    add(product) {\n      const items = [...this.itemsSubject.value];\n      const exists = items.find(i => i?._id === product._id || i === product);\n      if (!exists) items.push(product);\n      this.itemsSubject.next(items);\n      localStorage.setItem('wishlist', JSON.stringify(items));\n      this.api.post('/wishlist/add', {\n        productId: product._id\n      }).subscribe({\n        error: () => this.load()\n      });\n    }\n    remove(productId) {\n      const items = this.itemsSubject.value.filter(i => i?._id !== productId);\n      this.itemsSubject.next(items);\n      localStorage.setItem('wishlist', JSON.stringify(items));\n      this.api.post('/wishlist/remove', {\n        productId\n      }).subscribe({\n        error: () => this.load()\n      });\n    }\n    static {\n      this.ɵfac = function WishlistService_Factory(t) {\n        return new (t || WishlistService)(i0.ɵɵinject(i1.ApiService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: WishlistService,\n        factory: WishlistService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return WishlistService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}